# Лабораторная работа 3

**Название:** "Разработка драйверов сетевых устройств"

**Цель работы:** получить знания и навыки разработки драйверов сетевых интерфейсов для операционной системы Linux.

## Описание функциональности драйвера

Драйвер создает виртуальный сетевой интерфейс, который перехватывает пакеты родительского интерфейса и проверяет их на соответствие протоколу UDP и содержание конкретных данных (заранее заданной строки).

Состояние разбора пакетов выводится в файл в директории `/proc`.

## Инструкция по сборке

Запустить виртуальную машину с ядром нужной версии (4.15):

```sh
vagrant up
vagrant ssh
cd /vagrant
```

Собрать модуль драйвера:

```sh
make
```

## Инструкция пользователя

Установить модуль драйвера:

```sh
sudo insmod lab3.ko target_if="lo" target_proc_name="lab4_stat" target_str="test"
```

Должны быть указаны следующие параметры:

* `target_if`: интерфейс, от которого наследуется перехватывающий интерфейс (в примере выше указан _loopback_ интерфейс);
* `target_proc_name`: имя файла со статистикой, который будет доступен в `/proc` (в примере выше драйвером создается `/proc/lab4_stat`);
* `target_str`: строка, на соответствие которой проверяется содержимое UDP пакетов.


Если в `target_str` присутствуют пробелы, нужно задавать ее в формате `'"string"'`.

```sh
sudo insmod lab3.ko target_if="lo" target_proc_name="lab4_stat" target_str='"Hello world"'
```

## Примеры использования

Передача пакета и проверка статистики:

```sh
$ echo -n "test" >/dev/udp/127.0.0.1/8000
$ cat /proc/lab4_stat
Packets received: 1
Bytes received: 32
Packets transmitted: 0
Bytes transmitted: 0
```
